apiVersion: apps/v1 # Define a versão da API para o Deployment
kind: Deployment # Define o tipo do recurso como Deployment
metadata: # Metadados do Deployment
  labels: # Rótulos para identificar o Deployment
    app: nginx-deployment
  name: nginx-deployment # Nome do Deployment
spec: # Especificações do Deployment
  replicas: 1 # Número de réplicas (Pods) desejadas
  selector: # Seletor para identificar os Pods gerenciados por este Deployment
    matchLabels:
      app: nginx-deployment
  strategy: {} # Estratégia de atualização (padrão)
  template: # Template para os Pods gerenciados por este Deployment
    metadata: # Metadados dos Pods
      labels: # Rótulos para os Pods
        app: nginx-deployment
    spec: # Especificações dos Pods
      containers: # Lista de contêineres no Pod
      - image: nginx:1.19.2 # Imagem do contêiner (Nginx versão 1.7.9)
        name: nginx # Nome do contêiner
        resources: # Recursos (CPU/memória) alocados para o contêiner (padrão)
          limits: # Limites de recursos (nenhum definido)
            cpu: "0.5" # Limite de CPU
            memory: 256Mi # Limite de memória
          requests: # Requisições de recursos (nenhum definido)
            cpu: "0.25" # Requisição de CPU
            memory: 128Mi # Requisição de memória
        readinessProbe: # Configuração da sonda de prontidão como se fosse um health check
          exec: # Tipo de sonda HTTP ou TCP ou exec
            command: # Comando a ser executado para verificação
            - curl # Comando curl para verificar a prontidão
            - -f # Flag para falhar em caso de erro HTTP
            - http://localhost:80/ # URL a ser verificada
          initialDelaySeconds: 5 # Tempo inicial antes da primeira verificação
          periodSeconds: 10 # Intervalo entre as verificações
          timeoutSeconds: 3 # Tempo limite para a verificação
          successThreshold: 1 # Número de sucessos necessários para considerar o contêiner como pronto
          failureThreshold: 3 # Número de falhas antes de considerar o contêiner como não pronto